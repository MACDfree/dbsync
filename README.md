# 背景/需求

目前标准产品有MySQL、Oracle、Sql Server三种类型的开发库、演示库和空库，平时会有新功能开发、Bug修改，由于没有明确的规范。导致出现新功能在Sql Server开发库中开发，Bug在MySQL中修改，过程中的数据库脚本并不能保证在所有库都执行，导致每个库都有不小的差异。

为了解决此问题，需要有三种数据库的表结构和数据差异同步工具。

# 总体设计

工具整体功能包括：结构比对、数据比对、传输格式、解析执行。

## 结构比对

对比两个库的表、字段、字段类型和字段长度，输出的结果包括：只在源库中存在的表、只在目标库中存在的表、只在源库中存在的字段、只在目标库中存在的字段、字段类型或长度不同的字段。

## 数据比对

针对不同的表选取指定字段作为基准进行数据比对，输出的结果包括：指定表只在源库中存在的记录、指定表只在目标库中存在的记录、指定表中有差异的记录。

## 传输格式

原先的格式为SQL语句，但不同数据的SQL语法会有所差异，导致要导出三份SQL脚本，增大了维护量。现考虑以XML作为传输格式，实现数据库的无关性。示例格式见`src/main/resources/db.xml`。其中`task`节点下包括针对某个结果的一系列动作，如果是对数据操作要考虑对一个`task`起一个事务

## 解析执行

实质就是解析XML，考虑兼容不同数据库。